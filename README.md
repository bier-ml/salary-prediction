# salary-prediction
Salary prediction task for Rabota.ru

## Demo

TODO upload demo
![Demo](data/demo.gif)

## Technologies

- Python
- Streamlit for a web-service
- Pandas and Jupyter notebooks for data preprocessing and analysis
- DVC for dataset versioning

### Methodology

TODO

## Data Preprocessing

TODO

## Training Pipeline

### Dataset

В качестве разбиения на `train` `test` `validation` была выбрана пропорция 80:10:10.
Из-за того, что датасет изначально 
был сбалансирован проводилась случайная выборка без дополнительной стратификации. В процессе обучения, модель видела
только `train` множество, после каждой эпохи считались метрики на `validation` множестве, чтобы предотврадить
переобучение (где применимо) и обученная модель валидировалась на `test` множестве.

### Metrics

В качестве метрик была выбрана MAE, так как она легко интерпретируется и менее чувствительна к выбросам. С этой метрикой оптимизация во время обучения модели также эффективна с вычислительной точки зрения и более понятна для бизнеса в контексте прогнозирования заработной платы.

## Testing and Validation

### Experimental Setup

В качестве экспериментов были обучены и провалидированы декартово множество всех моделей и всех эмбедингов на всех
обозначенных выше метриках. Результат считался положительным, если при кросс-валидации на тестовом датасете метрика
превышала 0.5, так как
данный результат может
считаться не случайным.

### Experiments

| Model                     | Embedding                      | MAE | 
|---------------------------|--------------------------------|-----|
| **Linear Regression**     | **RuBERT-tiny**                | 
| **Linear Regression**     | **RuBERT**                     |
| **Linear Regression**     | **FastText**                   |
| **Linear Regression**     | **Sentence RuBERT**            |
| **Linear Regression**     | **Sentence Multilingual BERT** |
| **CatBoost Regressor**    | **RuBERT-tiny**                |
| **CatBoost Regressor**    | **RuBERT**                     |
| **CatBoost Regressor**    | **FastText**                   |
| **CatBoost Regressor**    | **Sentence RuBERT**            |
| **CatBoost Regressor**    | **Sentence Multilingual BERT** | 
| **Two Layers Perceptron** | **RuBERT-tiny**                | 
| **Two Layers Perceptron** | **RuBERT**                     | 
| **Two Layers Perceptron** | **FastText**                   | 
| **Two Layers Perceptron** | **Sentence RuBERT**            |
| **Two Layers Perceptron** | **Sentence Multilingual BERT** | 

## Deployment

Все модели были реализованы с использованием абстрактных интерфейсов, что позволяет единообразно использовать их в
сервисе и при необходимости добавлять новые модели. Взаимодействие моделей с пользователем происходит через streamlit
web-service. При загрузке своего резюме пользователю отображается предсказанная зарплата.

## Product Details

### Context

TODO

### Interface

Изначально, пользователю предлагается загрузить свое резюме -- мы реализовали подгрузку резюме в формате Word, так как
это самый популярный формат резюме в 2023 году. После того, как пользователь загрузил свое резюме оно отобразится справа
на главной странице, будет отображена предсказанная зарплата.

### Scaling

Для того, чтобы улучшить пользовательский опыт пользования нашим сервисом, мы выбрали использование продвинутных
эмбеддингов, а не тяжелых моделей. Данное решение позволяет посчитать эмбеддинги датасета отдельно в оффлайн режиме, а в
онлайне обрабатывать только пользовательские запросы, что положительно сказалось на общей производительности.

Помимо этого, мы реализовали сервис и бэкэнд, используя парадигму ООП и реализовали соответствующие интерфейсы, таким
образом масштабировать нас сервис и добавлять функциональность очень удобно.

## How to run

Для того, чтобы запустить web сервис изначально нужно восстановить виртуальное окружение:

```shell
poetry shell
poetry install --with web
```

И запустить сервис

```shell
poetry run streamlit run web/app.py
```

PS Первый раз запуск может быть более длительным из-за скачивания необходимых эмбеддингов
